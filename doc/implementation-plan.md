# 投資リターン計算機 実装計画書

## Phase 1: MVP実装（必須機能）

### フェーズ1-1: 環境構築とプロジェクトセットアップ（予定工数: 2時間）
- [ ] Next.js プロジェクトの初期化（TypeScript、App Router）
- [ ] Tailwind CSS の設定
- [ ] ESLint、Prettier の設定
- [ ] 基本的なフォルダ構造の作成
- [ ] Gitリポジトリの初期化とREADME作成

### フェーズ1-2: 型定義とデータモデル（予定工数: 1時間）
- [ ] TypeScript 型定義ファイルの作成（types/index.ts）
- [ ] Simulation インターフェースの定義
- [ ] CalculationParams インターフェースの定義
- [ ] CalculationResult インターフェースの定義
- [ ] YearlyData インターフェースの定義

### フェーズ1-3: 計算ロジックの実装（予定工数: 4時間）
- [ ] 複利計算関数の実装（年複利）
- [ ] 複利計算関数の実装（月複利）
- [ ] 単利計算関数の実装
- [ ] 定期積立計算の組み込み
- [ ] ボーナス積立計算の組み込み
- [ ] 計算ロジックの単体テスト作成

### フェーズ1-4: 状態管理の実装（予定工数: 2時間）
- [ ] Zustand のインストールと設定
- [ ] SimulationStore の実装
- [ ] LocalStorage との連携機能
- [ ] ストアのテスト作成

### フェーズ1-5: 基本UIコンポーネント（予定工数: 3時間）
- [ ] 共通UIコンポーネントの作成（Button、Card、Input）
- [ ] レイアウトコンポーネントの作成（Header、Footer）
- [ ] テーマ切り替え機能（ダークモード）の実装
- [ ] レスポンシブデザインの確認

### フェーズ1-6: 計算機フォームの実装（予定工数: 4時間）
- [ ] CalculatorForm コンポーネントの作成
- [ ] React Hook Form の導入と設定
- [ ] Zod によるバリデーションスキーマの作成
- [ ] 入力フィールドコンポーネントの作成
- [ ] リアルタイムバリデーションの実装
- [ ] フォームのテスト作成

### フェーズ1-7: 計算結果表示の実装（予定工数: 3時間）
- [ ] ResultDisplay コンポーネントの作成
- [ ] 数値フォーマット関数の実装
- [ ] 結果カードレイアウトの作成
- [ ] アニメーション効果の追加
- [ ] コンポーネントのテスト作成

### フェーズ1-8: グラフ表示機能（予定工数: 5時間）
- [ ] Chart.js または Recharts のインストール
- [ ] AssetChart コンポーネントの作成（資産推移）
- [ ] BreakdownChart コンポーネントの作成（内訳表示）
- [ ] グラフのレスポンシブ対応
- [ ] グラフアニメーションの設定
- [ ] グラフのカスタマイズオプション追加

### フェーズ1-9: データ保存・管理機能（予定工数: 3時間）
- [ ] StorageService クラスの実装
- [ ] シミュレーション保存機能の実装
- [ ] シミュレーション一覧表示機能
- [ ] 編集・削除機能の実装
- [ ] データマイグレーション機能の追加

### フェーズ1-10: CSVエクスポート機能（予定工数: 2時間）
- [ ] CSV生成ロジックの実装
- [ ] ダウンロード機能の実装
- [ ] エクスポートボタンの追加
- [ ] 日本語対応（文字化け対策）

### フェーズ1-11: メインページ統合（予定工数: 3時間）
- [ ] メインページレイアウトの作成
- [ ] 各コンポーネントの統合
- [ ] ページ間ナビゲーションの実装
- [ ] ローディング状態の実装
- [ ] エラーハンドリングの実装

### フェーズ1-12: テストとバグ修正（予定工数: 4時間）
- [ ] 統合テストの実行
- [ ] クロスブラウザテスト
- [ ] モバイル表示の確認
- [ ] パフォーマンステスト
- [ ] バグ修正とリファクタリング

### フェーズ1-13: デプロイ準備（予定工数: 2時間）
- [ ] 本番環境用のビルド設定
- [ ] 環境変数の設定
- [ ] Vercelへのデプロイ設定
- [ ] デプロイテスト
- [ ] ドメイン設定（必要に応じて）

## Phase 2: 追加機能実装

### フェーズ2-1: 複数シナリオ比較機能（予定工数: 4時間）
- [ ] 比較画面の作成
- [ ] ComparisonChart コンポーネントの実装
- [ ] 比較テーブルの作成
- [ ] シナリオ選択UIの実装
- [ ] 比較結果のエクスポート機能

### フェーズ2-2: 税金計算機能（予定工数: 3時間）
- [ ] 税金計算ロジックの実装
- [ ] 税率設定UIの追加
- [ ] 税引き後リターンの表示
- [ ] 税金シミュレーション機能

### フェーズ2-3: インフレ考慮機能（予定工数: 3時間）
- [ ] インフレ率入力フィールドの追加
- [ ] 実質リターン計算ロジック
- [ ] インフレ調整後グラフの表示
- [ ] 購買力の推移表示

### フェーズ2-4: 多言語対応（予定工数: 5時間）
- [ ] next-i18next の設定
- [ ] 日本語リソースファイルの作成
- [ ] 英語翻訳とリソースファイル作成
- [ ] 中国語（繁体字）翻訳とリソースファイル作成
- [ ] 言語切り替えUIの実装
- [ ] 数値・日付フォーマットの国際化

### フェーズ2-5: 高度なデータ管理（予定工数: 3時間）
- [ ] データのインポート機能
- [ ] バックアップ・リストア機能
- [ ] データ圧縮機能（容量対策）
- [ ] シミュレーションのタグ付け機能

### フェーズ2-6: UI/UX改善（予定工数: 3時間）
- [ ] ツールチップの追加
- [ ] 使い方ガイドの作成
- [ ] ショートカットキーの実装
- [ ] アクセシビリティ改善
- [ ] パフォーマンス最適化

## 実装優先順位

### 優先度: 高（MVP必須）
1. 基本的な複利計算機能
2. 定期積立計算
3. グラフ表示
4. データ保存機能
5. モバイル対応

### 優先度: 中
1. CSVエクスポート
2. ダークモード
3. ボーナス積立
4. 複数シミュレーション管理

### 優先度: 低（Phase 2）
1. 複数シナリオ比較
2. 税金計算
3. インフレ考慮
4. 多言語対応

## リスクと対策

### 技術的リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| グラフライブラリのパフォーマンス | 高 | 軽量なライブラリの選定、遅延ロード |
| LocalStorage容量制限 | 中 | データ圧縮、古いデータの自動削除 |
| 計算精度の問題 | 高 | Decimal.jsなどの高精度計算ライブラリ使用 |
| モバイル表示の崩れ | 中 | 開発初期からレスポンシブ確認 |

## 完了基準

### MVP完了条件
- [ ] 全ての必須機能が実装済み
- [ ] 主要ブラウザで動作確認済み
- [ ] モバイル表示が正常
- [ ] 基本的なテストがパス
- [ ] Vercelにデプロイ済み

### Phase 2完了条件
- [ ] 追加機能が計画通り実装済み
- [ ] パフォーマンス目標達成
- [ ] 多言語対応完了
- [ ] ユーザビリティテスト実施

## 備考
- 各フェーズ完了時にコードレビューを実施
- 重要な機能追加時はユーザーテストを検討
- パフォーマンス計測は定期的に実施
- セキュリティアップデートは随時対応